USE TREINAMENTO
--UPDATES

SELECT * FROM PRODUTO
--ESCOLHEU GRUPO PADRAO, MUDAR PADRAO PARA NULO

UPDATE PRODUTO SET GRUPO = '' WHERE GRUPO = 'PADRAO'
--UPDATE PRODUTO SET GRUPO = '' WHERE GRUPO = 'PADRAO' AND INATIVO = 1
SELECT * FROM PRODUTO ORDER BY GRUPO


--SEMPRE TESTAR O UPDATE COM SELECT DE MESMA CLAUSULA
SELECT * FROM PRODUTO WHERE GRUPO = 'CFTV'
UPDATE PRODUTO SET GRUPO = '' WHERE GRUPO = 'CFTV'

SELECT * FROM PRODUTO WHERE CODIGO = '1141'
SELECT * FROM PRODUTO WHERE CODIGO = '1804'

--CRIANDO VENDA 021, COM ITENS, FORMA DE PAGAMENTO E TITULOS
SELECT * FROM VENDA
SELECT * FROM VENDAITENS WHERE VENDAID = 21
SELECT * FROM TITULO WHERE VENDAID = 21

UPDATE TITULO SET VALOR = (SELECT SUM(VI.QTDE * VI.VRUNITARIO) FROM VENDAITENS AS VI WHERE VI.VENDAID = TITULO.VENDAID)

--UPDATE TITULO SET VALOR = (SELECT SUM(VI.QTDE * VI.VRUNITARIO) FROM VENDAITENS AS VI WHERE VI.VENDAID = 21) WHERE VENDAID = 21
--MEU MODO DE FAZER, CREIO QUE ESTEJA MAIS CORRETO


--VERIFICAÇÃO
--UPDATE TITULO SET VALOR = 0
--SELECT * FROM VENDA
--SELECT * FROM VENDAITENS 
--SELECT * FROM TITULO 

USE TREINAMENTO

--EXERCICIO

--VARIAS VENDAS, COM VARIOS PRODUTOS/ITENS E VARIOS TITULOS PARA AS VENDAS
--POPULAR AS TABELAS PARA OS PROXIMOS VIDEOS

--VENDA22
INSERT INTO VENDA(CLIENTEID, FORMAID, DATAPEDIDO, TIPOVENDA, VENDEDOR, OBS)
VALUES (3313, 10, '05/06/2025', 'PEDIDO', 'LEMES','ENTREGAR ATE AS 16')

INSERT INTO VENDAITENS(VENDAID, PRODUTOID, QTDE, VRUNITARIO)
VALUES(22, 45785, 6, 35)

INSERT INTO VENDAITENS(VENDAID, PRODUTOID, QTDE, VRUNITARIO)
VALUES(22, 45791, 4, 50)

INSERT INTO VENDAITENS(VENDAID, PRODUTOID, QTDE, VRUNITARIO)
VALUES(22, 45839, 2, 156)

INSERT INTO VENDAITENS(VENDAID, PRODUTOID, QTDE, VRUNITARIO)
VALUES(22, 45899, 1, 350)

INSERT INTO VENDAITENS(VENDAID, PRODUTOID, QTDE, VRUNITARIO)
VALUES(22, 45953, 8, 120)

--TOTAL -> 2032

INSERT INTO TITULO(DATAVENCIMENTO, VALOR, CENTRORESULTADO, DOCUMENTO, CLIENTEID, FORMAID, TIPO, VENDAID)
VALUES('05/06/2025', 382, 'VENDAS', '1/22', 3313, 43, 'A PRAZO', 22)

INSERT INTO TITULO(DATAVENCIMENTO, VALOR, CENTRORESULTADO, DOCUMENTO, CLIENTEID, FORMAID, TIPO, VENDAID)
VALUES('10/07/2025', 330, 'VENDAS', '2/22', 3313, 43, 'A PRAZO', 22)

INSERT INTO TITULO(DATAVENCIMENTO, VALOR, CENTRORESULTADO, DOCUMENTO, CLIENTEID, FORMAID, TIPO, VENDAID)
VALUES('15/08/2025', 330, 'VENDAS', '3/22', 3313, 43, 'A PRAZO', 22)

INSERT INTO TITULO(DATAVENCIMENTO, VALOR, CENTRORESULTADO, DOCUMENTO, CLIENTEID, FORMAID, TIPO, VENDAID)
VALUES('10/09/2025', 330, 'VENDAS', '4/22', 3313, 43, 'A PRAZO', 22)

INSERT INTO TITULO(DATAVENCIMENTO, VALOR, CENTRORESULTADO, DOCUMENTO, CLIENTEID, FORMAID, TIPO, VENDAID)
VALUES('15/10/2025', 330, 'VENDAS', '5/22', 3313, 43, 'A PRAZO', 22)

INSERT INTO TITULO(DATAVENCIMENTO, VALOR, CENTRORESULTADO, DOCUMENTO, CLIENTEID, FORMAID, TIPO, VENDAID)
VALUES('10/11/2025', 330, 'VENDAS', '6/22', 3313, 43, 'A PRAZO', 22)

--VENDA23
INSERT INTO VENDA(CLIENTEID, FORMAID, DATAPEDIDO, TIPOVENDA, VENDEDOR, OBS)
VALUES (3341, 10, '05/06/2025', 'ONLINE', 'LAURO','ENTREGAR ATE AS 12')

INSERT INTO VENDAITENS(VENDAID, PRODUTOID, QTDE, VRUNITARIO)
VALUES(23, 68904, 3, 120)

INSERT INTO VENDAITENS(VENDAID, PRODUTOID, QTDE, VRUNITARIO)
VALUES(23, 68951, 3, 170)

INSERT INTO VENDAITENS(VENDAID, PRODUTOID, QTDE, VRUNITARIO)
VALUES(23, 69002, 1, 682.5)

INSERT INTO VENDAITENS(VENDAID, PRODUTOID, QTDE, VRUNITARIO)
VALUES(23, 69003, 2, 1300)

INSERT INTO VENDAITENS(VENDAID, PRODUTOID, QTDE, VRUNITARIO)
VALUES(23, 69078, 2, 135)

--TOTAL -> 4422.5

INSERT INTO TITULO(DATAVENCIMENTO, VALOR, CENTRORESULTADO, DOCUMENTO, CLIENTEID, FORMAID, TIPO, VENDAID)
VALUES('10/06/2025', 365, 'VENDAS', '1/23', 3341, 49, 'A PRAZO', 23)

INSERT INTO TITULO(DATAVENCIMENTO, VALOR, CENTRORESULTADO, DOCUMENTO, CLIENTEID, FORMAID, TIPO, VENDAID)
VALUES('10/07/2025', 365, 'VENDAS', '2/23', 3341, 49, 'A PRAZO', 23)

INSERT INTO TITULO(DATAVENCIMENTO, VALOR, CENTRORESULTADO, DOCUMENTO, CLIENTEID, FORMAID, TIPO, VENDAID)
VALUES('10/08/2025', 365, 'VENDAS', '3/23', 3341, 49, 'A PRAZO', 23)

INSERT INTO TITULO(DATAVENCIMENTO, VALOR, CENTRORESULTADO, DOCUMENTO, CLIENTEID, FORMAID, TIPO, VENDAID)
VALUES('10/09/2025', 365, 'VENDAS', '4/23', 3341, 49, 'A PRAZO', 23)

INSERT INTO TITULO(DATAVENCIMENTO, VALOR, CENTRORESULTADO, DOCUMENTO, CLIENTEID, FORMAID, TIPO, VENDAID)
VALUES('10/10/2025', 365, 'VENDAS', '5/23', 3341, 49, 'A PRAZO', 23)

INSERT INTO TITULO(DATAVENCIMENTO, VALOR, CENTRORESULTADO, DOCUMENTO, CLIENTEID, FORMAID, TIPO, VENDAID)
VALUES('10/11/2025', 365, 'VENDAS', '6/23', 3341, 49, 'A PRAZO', 23)

INSERT INTO TITULO(DATAVENCIMENTO, VALOR, CENTRORESULTADO, DOCUMENTO, CLIENTEID, FORMAID, TIPO, VENDAID)
VALUES('10/12/2025', 365, 'VENDAS', '7/23', 3341, 49, 'A PRAZO', 23)

INSERT INTO TITULO(DATAVENCIMENTO, VALOR, CENTRORESULTADO, DOCUMENTO, CLIENTEID, FORMAID, TIPO, VENDAID)
VALUES('10/01/2026', 365, 'VENDAS', '8/23', 3341, 49, 'A PRAZO', 23)

INSERT INTO TITULO(DATAVENCIMENTO, VALOR, CENTRORESULTADO, DOCUMENTO, CLIENTEID, FORMAID, TIPO, VENDAID)
VALUES('10/02/2026', 365, 'VENDAS', '9/23', 3341, 49, 'A PRAZO', 23)

INSERT INTO TITULO(DATAVENCIMENTO, VALOR, CENTRORESULTADO, DOCUMENTO, CLIENTEID, FORMAID, TIPO, VENDAID)
VALUES('10/03/2026', 365, 'VENDAS', '10/23', 3341, 49, 'A PRAZO', 23)

INSERT INTO TITULO(DATAVENCIMENTO, VALOR, CENTRORESULTADO, DOCUMENTO, CLIENTEID, FORMAID, TIPO, VENDAID)
VALUES('10/04/2026', 365, 'VENDAS', '11/23', 3341, 49, 'A PRAZO', 23)

INSERT INTO TITULO(DATAVENCIMENTO, VALOR, CENTRORESULTADO, DOCUMENTO, CLIENTEID, FORMAID, TIPO, VENDAID)
VALUES('10/05/2026', 407.5, 'VENDAS', '12/23', 3341, 49, 'A PRAZO', 23)

--VENDA24
INSERT INTO VENDA(CLIENTEID, FORMAID, DATAPEDIDO, TIPOVENDA, VENDEDOR, OBS)
VALUES (3470, 10, '05/06/2025', 'BALCAO', 'THIAGO','A BUSCAR')

INSERT INTO VENDAITENS(VENDAID, PRODUTOID, QTDE, VRUNITARIO)
VALUES(24, 82062, 1, 315)

INSERT INTO VENDAITENS(VENDAID, PRODUTOID, QTDE, VRUNITARIO)
VALUES(24, 82064, 4, 7.5)

INSERT INTO VENDAITENS(VENDAID, PRODUTOID, QTDE, VRUNITARIO)
VALUES(24, 82081, 2, 111)

INSERT INTO VENDAITENS(VENDAID, PRODUTOID, QTDE, VRUNITARIO)
VALUES(24, 82093, 2, 398)

INSERT INTO VENDAITENS(VENDAID, PRODUTOID, QTDE, VRUNITARIO)
VALUES(24, 82122, 1, 3220)

--TOTAL -> 4583

INSERT INTO TITULO(DATAVENCIMENTO, VALOR, CENTRORESULTADO, DOCUMENTO, CLIENTEID, FORMAID, TIPO, VENDAID)
VALUES('05/06/2025', 550, 'VENDAS', '1/24', 3470, 42, 'A PRAZO', 24)

INSERT INTO TITULO(DATAVENCIMENTO, VALOR, CENTRORESULTADO, DOCUMENTO, CLIENTEID, FORMAID, TIPO, VENDAID)
VALUES('10/07/2025', 550, 'VENDAS', '2/24', 3470, 42, 'A PRAZO', 24)

INSERT INTO TITULO(DATAVENCIMENTO, VALOR, CENTRORESULTADO, DOCUMENTO, CLIENTEID, FORMAID, TIPO, VENDAID)
VALUES('15/08/2025', 550, 'VENDAS', '3/24', 3470, 42, 'A PRAZO', 24)

INSERT INTO TITULO(DATAVENCIMENTO, VALOR, CENTRORESULTADO, DOCUMENTO, CLIENTEID, FORMAID, TIPO, VENDAID)
VALUES('10/09/2025', 550, 'VENDAS', '4/24', 3470, 42, 'A PRAZO', 24)

INSERT INTO TITULO(DATAVENCIMENTO, VALOR, CENTRORESULTADO, DOCUMENTO, CLIENTEID, FORMAID, TIPO, VENDAID)
VALUES('15/10/2025', 550, 'VENDAS', '5/24', 3470, 42, 'A PRAZO', 24)

INSERT INTO TITULO(DATAVENCIMENTO, VALOR, CENTRORESULTADO, DOCUMENTO, CLIENTEID, FORMAID, TIPO, VENDAID)
VALUES('10/11/2025', 550, 'VENDAS', '6/24', 3470, 42, 'A PRAZO', 24)

INSERT INTO TITULO(DATAVENCIMENTO, VALOR, CENTRORESULTADO, DOCUMENTO, CLIENTEID, FORMAID, TIPO, VENDAID)
VALUES('10/12/2025', 550, 'VENDAS', '7/24', 3470, 42, 'A PRAZO', 24)

INSERT INTO TITULO(DATAVENCIMENTO, VALOR, CENTRORESULTADO, DOCUMENTO, CLIENTEID, FORMAID, TIPO, VENDAID)
VALUES('20/01/2026', 773, 'VENDAS', '8/24', 3470, 42, 'A PRAZO', 24)

--VENDA25
INSERT INTO VENDA(CLIENTEID, FORMAID, DATAPEDIDO, TIPOVENDA, VENDEDOR, OBS)
VALUES (3530, 10, '05/06/2025', 'PEDIDO', 'DAIVID','ENTREGAR')

INSERT INTO VENDAITENS(VENDAID, PRODUTOID, QTDE, VRUNITARIO)
VALUES(25, 91351, 10, 1.25)

INSERT INTO VENDAITENS(VENDAID, PRODUTOID, QTDE, VRUNITARIO)
VALUES(25, 91342, 4, 86.80)

INSERT INTO VENDAITENS(VENDAID, PRODUTOID, QTDE, VRUNITARIO)
VALUES(25, 91323, 20, 0.5)

INSERT INTO VENDAITENS(VENDAID, PRODUTOID, QTDE, VRUNITARIO)
VALUES(25, 91305, 12, 8.5)

INSERT INTO VENDAITENS(VENDAID, PRODUTOID, QTDE, VRUNITARIO)
VALUES(25, 91285, 8, 2.5)

--TOTAL -> 491.7

INSERT INTO TITULO(DATAVENCIMENTO, VALOR, CENTRORESULTADO, DOCUMENTO, CLIENTEID, FORMAID, TIPO, VENDAID)
VALUES('15/07/2025', 491.7, 'VENDAS', '1/25', 3530, 56, 'A PRAZO', 25)

--SELECTS TESTES
SELECT * FROM VENDA
SELECT * FROM PRODUTO
SELECT * FROM FORMAPAGAMENTO
SELECT * FROM TITULO